{"version":3,"sources":["visuals/scriptVisualTests.ts"],"names":["powerbitests","powerbitests.ScriptVisualHelpers","powerbitests.ScriptVisualHelpers.buildUpdateOptions","powerbitests.ScriptVisualHelpers.buildInitOptions"],"mappings":"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","file":"visuals/scriptVisualTests.js","sourcesContent":["/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved. \r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *   \r\n *  The above copyright notice and this permission notice shall be included in \r\n *  all copies or substantial portions of the Software.\r\n *   \r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\n\r\n\r\n\r\nmodule powerbitests {\r\n    import ScriptVisual = powerbi.visuals.ScriptVisual;\r\n    import scriptVisualCapabilities = powerbi.visuals.scriptVisualCapabilities;\r\n\r\n    module ScriptVisualHelpers {\r\n        export function buildUpdateOptions(viewport: powerbi.IViewport, objects: powerbi.DataViewObjects, imageData?: string): powerbi.VisualUpdateOptions {\r\n            let options: powerbi.VisualUpdateOptions = <powerbi.VisualUpdateOptions>{\r\n                viewport: viewport,\r\n                dataViews: [{\r\n                    metadata: {\r\n                        columns: [],\r\n                        objects: objects,\r\n                    }\r\n                }],\r\n            };\r\n\r\n            if (imageData) {\r\n                options.dataViews[0].scriptResult = {\r\n                    imageBase64: imageData\r\n                };\r\n            }\r\n\r\n            return options;\r\n        };\r\n\r\n        export function buildInitOptions(element: JQuery, viewport: powerbi.IViewport, hostServices: powerbi.IVisualHostServices) {            \r\n            let options = {\r\n                element: $(element[0]),\r\n                host: hostServices,\r\n                style: powerbi.visuals.visualStyles.create(),\r\n                viewport: viewport,\r\n                animation: {\r\n                    transitionImmediate: true\r\n                },\r\n            };\r\n\r\n            return options;\r\n        }\r\n    }\r\n\r\n    describe(\"scriptVisual Tests\", () => {\r\n\r\n        it('registered capabilities', () => {\r\n            let pluginCapabilities = powerbi.visuals.visualPluginFactory.create().getPlugin('scriptVisual').capabilities;\r\n            expect(pluginCapabilities.toString()).toBe(scriptVisualCapabilities.toString());\r\n        });\r\n\r\n        it(\"Capabilities dataViewMappings should include the script result definition\", () => {\r\n            expect(scriptVisualCapabilities.dataViewMappings).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings.length).toBe(1);\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult.dataInput).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult.dataInput.table).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult.script).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult.script.source).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataViewMappings[0].scriptResult.script.provider).toBeDefined();\r\n        });\r\n\r\n        it(\"Capabilities should include dataRoles\", () => {\r\n            expect(scriptVisualCapabilities.dataRoles).toBeDefined();\r\n            expect(scriptVisualCapabilities.dataRoles.length).toBe(1);\r\n            expect(scriptVisualCapabilities.dataRoles[0].name).toBe('Values');\r\n        });\r\n\r\n        it('registered capabilities: objects', () => {\r\n            expect(powerbi.visuals.visualPluginFactory.create().getPlugin('scriptVisual').capabilities.objects).toBeDefined();\r\n        });\r\n\r\n        describe('rendering', () => {\r\n            let element: JQuery;\r\n            let viewport: powerbi.IViewport;\r\n            let scriptVisual: ScriptVisual;\r\n\r\n            beforeEach(() => {\r\n                element = powerbitests.helpers.testDom('200', '300');\r\n                viewport = {\r\n                    height: element.height(),\r\n                    width: element.width() \r\n                };\r\n                let hostServices = mocks.createVisualHostServices();\r\n                let initOptions = ScriptVisualHelpers.buildInitOptions(element, viewport, hostServices);\r\n                scriptVisual = new ScriptVisual({ canRefresh: true });\r\n                scriptVisual.init(initOptions);\r\n            });\r\n\r\n            it('no visual configuration', () => {\r\n                expect(element.children().length).toBe(0);\r\n            });\r\n\r\n            it('empty div with no saved image', () => {\r\n                let visualUpdateOptions = ScriptVisualHelpers.buildUpdateOptions(viewport, {});\r\n                scriptVisual.update(visualUpdateOptions);\r\n\r\n                //Verifying the DOM\r\n                let imageDiv = element.find('.imageBackground');\r\n                expect(imageDiv.css('backgroundImage')).toBe('none');\r\n            });\r\n\r\n            it('visual shows last saved image from objects', () => {\r\n                let visualUpdateOptions = ScriptVisualHelpers.buildUpdateOptions(viewport, {\r\n                    lastSavedImage: { imageUrl: 'data:image/png;base64,datadatadata' }\r\n                });\r\n                scriptVisual.update(visualUpdateOptions);\r\n\r\n                //Verifying the DOM\r\n                let imageDiv = element.find('.imageBackground');\r\n                let backgroundImage = imageDiv.css('backgroundImage');\r\n                let isUrlEqual = (backgroundImage === 'url(data:image/png;base64,datadatadata)') || (backgroundImage === 'url(\"data:image/png;base64,datadatadata\")');\r\n                expect(isUrlEqual).toBeTruthy();\r\n                expect(imageDiv.css('height')).toBe(viewport.height + 'px');\r\n                expect(imageDiv.css('width')).toBe(viewport.width + 'px');\r\n            });\r\n\r\n            it('visual shows the image from the dataView result', () => {\r\n                let visualUpdateOptions = ScriptVisualHelpers.buildUpdateOptions(viewport, {\r\n                    lastSavedImage: { imageUrl: 'data:image/png;base64,datadatadata' }\r\n                }, 'imageimageimage');\r\n                scriptVisual.update(visualUpdateOptions);\r\n\r\n                //Verifying the DOM\r\n                let imageDiv = element.find('.imageBackground');\r\n                let backgroundImage = imageDiv.css('backgroundImage');\r\n                let isUrlEqual = (backgroundImage === 'url(data:image/png;base64,imageimageimage)') || (backgroundImage === 'url(\"data:image/png;base64,imageimageimage\")');\r\n                expect(isUrlEqual).toBeTruthy();\r\n                expect(imageDiv.css('height')).toBe(viewport.height + 'px');\r\n                expect(imageDiv.css('width')).toBe(viewport.width + 'px');\r\n            });\r\n\r\n            it('visual with static image shows a warning', () => {\r\n                let warningSpy = jasmine.createSpy('setWarnings');\r\n                let hostServices = mocks.createVisualHostServices();\r\n                hostServices.setWarnings = warningSpy;\r\n\r\n                scriptVisual = new ScriptVisual({ canRefresh: false });\r\n                let visualInitOptions = ScriptVisualHelpers.buildInitOptions(element, viewport, hostServices);\r\n                scriptVisual.init(visualInitOptions);\r\n\r\n                let visualUpdateOptions = ScriptVisualHelpers.buildUpdateOptions(viewport, {\r\n                    lastSavedImage: { imageUrl: 'data:image/png;base64,datadatadata' }\r\n                }, 'imageimageimage');\r\n                scriptVisual.update(visualUpdateOptions);\r\n\r\n                expect(warningSpy).toHaveBeenCalled();\r\n                expect(warningSpy.calls.count()).toBe(1);\r\n                expect(warningSpy.calls.argsFor(0)[0][0].code).toBe('ScriptVisualNotRefreshed');\r\n            });\r\n\r\n            it('non-static visual should not show a warning', () => {\r\n                let warningSpy = jasmine.createSpy('setWarnings');\r\n                let hostServices = mocks.createVisualHostServices();\r\n                hostServices.setWarnings = warningSpy;\r\n\r\n                scriptVisual = new ScriptVisual({ canRefresh: true });\r\n                let visualInitOptions = ScriptVisualHelpers.buildInitOptions(element, viewport, hostServices);\r\n                scriptVisual.init(visualInitOptions);\r\n\r\n                let visualUpdateOptions = ScriptVisualHelpers.buildUpdateOptions(viewport, {\r\n                    lastSavedImage: { imageUrl: 'data:image/png;base64,datadatadata' }\r\n                }, 'imageimageimage');\r\n                scriptVisual.update(visualUpdateOptions);\r\n\r\n                expect(warningSpy).not.toHaveBeenCalled();\r\n            });\r\n        });\r\n    });\r\n}\r\n"],"sourceRoot":"/source/"}