{"version":3,"sources":["visuals/imageVisualTests.ts"],"names":["powerbitests","powerbitests.ImageVisualDataBuilder","powerbitests.ImageVisualDataBuilder.constructor","powerbitests.ImageVisualDataBuilder.element","powerbitests.ImageVisualDataBuilder.imageBackgroundElement","powerbitests.ImageVisualDataBuilder.image","powerbitests.ImageVisualDataBuilder.imageUrl","powerbitests.ImageVisualDataBuilder.imageScalingType","powerbitests.ImageVisualDataBuilder.createViewport","powerbitests.ImageVisualDataBuilder.init","powerbitests.ImageVisualDataBuilder.update"],"mappings":"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","file":"visuals/imageVisualTests.js","sourcesContent":["/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved. \r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *   \r\n *  The above copyright notice and this permission notice shall be included in \r\n *  all copies or substantial portions of the Software.\r\n *   \r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\n\r\n\r\n\r\nmodule powerbitests {\r\n    import ImageVisual = powerbi.visuals.ImageVisual;\r\n    import imageVisualCapabilities = powerbi.visuals.imageVisualCapabilities;\r\n\r\n    describe(\"ImageVisual\", () => {\r\n        let imageVisualDataBuilder: ImageVisualDataBuilder;\r\n        const imageBase64value =\r\n            \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAkFBMVEX\" +\r\n            \"////+/v78+/vz8e/29PLr5+Tw7etwWEdbPyzTy8Tj3trn4t78+/mTgHOsnZLCt69PMRzX0cvJwLml\" +\r\n            \"lYm1qJ53YE8zEQBsUj9QMR68sKZHKRREJA+aiHx+aViGcF7q5t6NeWpkSDafjoAvCwA4FgC4rKSnm\" +\r\n            \"JE+HAaKdWhVOCeHeG1TPi5jT0BxX1J5aFtlSznQd83pAAACIklEQVQYGZXBiVraQBiG0ff7s8BMQs\" +\r\n            \"JkEaNsalspXbj/u2us1Scg7TM9B64R/0X8H6FMxBPu53ePiCS6bz/qkljCfatK4hnHIxjRjPURiWj\" +\r\n            \"Cf69AIpYIP44eRCxRdj/bBBFLkHZHh4glQbYOiGgykgoRT2QDIprIhxwRr3AJ8VTuChDvJPFPZQri\" +\r\n            \"jQyQuE6vTC94IUiLHMRHMnFGQmSHu+f7vkBckIDcN0PXfR7qJmR5Caj4+mnR1LN5InFGENrDYVHVL\" +\r\n            \"viiKIJzIWQp65uG0anCmBKu7ytvTCjNdmVwmJWqDogJEU4NIzPTG0YlCEzdAjFhDPOMP/QbryTAWF\" +\r\n            \"cYE4L262lfucx4l7jq0CFAtvGICeGTpN6v5svl/DTrN5t+9rB8/vR0WyMw6kfElHiYMUp8XS22/Wx\" +\r\n            \"1WvWbRRXESOT7RGJKrOYmE5cEIm094oxY32cISTaSkMxMYpQOHnHOcDcO443Eu9TliAtSulxjXFHu\" +\r\n            \"SsQHxn4ucYVAfCT8vZOIV3KYYUSznfLlgBFHZBk0S09JFOEzjM8PASQuyMQFEQpkNLPOQBITxjVJj\" +\r\n            \"WTkj4s6Y0oi/eIQ54QbwAzyuhtclpa8kAT17VODuCCaKgczIE2LXSnJDAj9022D+ECExy5jJEbiRV\" +\r\n            \"r3N3ePCeIKoXq/HnzKq9R3m+XzvMpBXCWQa7f9ZrvdbvrV/O521gbAxN+IURKGqm3brvElIxP/ImN\" +\r\n            \"CJi78AkZVGOZlPDldAAAAAElFTkSuQmCC\";\r\n\r\n        beforeEach(() => {\r\n            imageVisualDataBuilder = new ImageVisualDataBuilder();\r\n        });\r\n\r\n        it(\"ImageVisual registered capabilities\", () => {\r\n            expect(powerbi.visuals.visualPluginFactory.create().getPlugin(\"image\").capabilities).toBe(imageVisualCapabilities);\r\n        });\r\n\r\n        it(\"ImageVisual registered capabilities: objects\", () => {\r\n            expect(powerbi.visuals.visualPluginFactory.create().getPlugin(\"image\").capabilities.objects).toBeDefined();\r\n        });\r\n\r\n        it(\"Image no visual configuration\", () => {\r\n            expect(imageVisualDataBuilder.element.children().length).toBe(0);\r\n        });\r\n\r\n        it(\"Image to about:blank\", () => {\r\n            imageVisualDataBuilder.imageUrl = \"about:blank\";\r\n            imageVisualDataBuilder.update();\r\n\r\n            //invalid image data url\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css(\"background-image\")).toBe(\"none\");\r\n        });\r\n\r\n        it(\"Image from base64 string\", () => {\r\n            imageVisualDataBuilder.imageUrl = imageBase64value;\r\n            imageVisualDataBuilder.update();\r\n\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css(\"background-image\")).toBe(\"url(\" + imageBase64value + \")\");\r\n        });\r\n\r\n        it(\"Image DOM Verification\", () => {\r\n            imageVisualDataBuilder.imageUrl = imageBase64value;\r\n            imageVisualDataBuilder.update();\r\n\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-image')).toBe('url(' + imageBase64value + ')');\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-size')).toBe('contain');\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('height')).toBe('200px');\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('width')).toBe('300px');\r\n        });\r\n\r\n        it('Image scaling types', () => {\r\n            imageVisualDataBuilder.imageUrl = imageBase64value;\r\n\r\n            // Fit\r\n            imageVisualDataBuilder.imageScalingType = \"Fit\";\r\n            imageVisualDataBuilder.update();\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-size')).toBe('100% 100%');\r\n\r\n            // Fill\r\n            imageVisualDataBuilder.imageScalingType = \"Fill\";\r\n            imageVisualDataBuilder.update();\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-size')).toBe('cover');\r\n\r\n            // Reset to default\r\n            imageVisualDataBuilder.imageScalingType = null;\r\n            imageVisualDataBuilder.update();\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-size')).toBe('contain');\r\n\r\n            // Normal\r\n            imageVisualDataBuilder.imageScalingType = \"Normal\";\r\n            imageVisualDataBuilder.update();\r\n            expect(imageVisualDataBuilder.imageBackgroundElement.css('background-size')).toBe('contain');\r\n        });\r\n    });\r\n\r\n    class ImageVisualDataBuilder {\r\n        private _element: JQuery;\r\n\r\n        public get element(): JQuery {\r\n            return this._element;\r\n        }\r\n\r\n        public get imageBackgroundElement(): JQuery {\r\n            return this._element.find('.imageBackground');\r\n        }\r\n\r\n        private _hostService: powerbi.IVisualHostServices;\r\n\r\n        private _style: powerbi.IVisualStyle;\r\n\r\n        private _image: ImageVisual;\r\n\r\n        public get image(): ImageVisual {\r\n            return this._image;\r\n        }\r\n\r\n        private _imageUrl: string;\r\n\r\n        public get imageUrl(): string {\r\n            return this._imageUrl;\r\n        }\r\n\r\n        public set imageUrl(value: string) {\r\n            this._imageUrl = value;\r\n        }\r\n\r\n        private _imageScalingType: string;\r\n\r\n        public get imageScalingType(): string {\r\n            return this._imageScalingType;\r\n        }\r\n\r\n        public set imageScalingType(value: string) {\r\n            this._imageScalingType = value;\r\n        }\r\n\r\n        constructor() {\r\n            this._element = powerbitests.helpers.testDom(\"200\", \"300\");\r\n            this._hostService = mocks.createVisualHostServices();\r\n            this._style = powerbi.visuals.visualStyles.create();\r\n            this._image = new ImageVisual();\r\n\r\n            this.init();\r\n        }\r\n\r\n        private createViewport(): powerbi.IViewport {\r\n            return {\r\n                height: this._element.height(),\r\n                width: this._element.width(),\r\n            };\r\n        }\r\n\r\n        private init() {\r\n            this.image.init({\r\n                element: this._element,\r\n                host: this._hostService,\r\n                style: this._style,\r\n                viewport: this.createViewport(),\r\n                animation: {\r\n                    transitionImmediate: true\r\n                }\r\n            });\r\n        }\r\n\r\n        public update() {\r\n\r\n            let objects: powerbi.DataViewObjects = {\r\n                general: {\r\n                    imageUrl: this.imageUrl\r\n                }\r\n            };\r\n\r\n            if (this.imageScalingType) {\r\n                objects[\"imageScaling\"] = { imageScalingType: this.imageScalingType };\r\n            }\r\n\r\n            this.image.update({\r\n                viewport: this.createViewport(),\r\n                dataViews: [{\r\n                    metadata: {\r\n                        columns: [],\r\n                        objects: objects\r\n                    }\r\n                }]\r\n            });\r\n        }\r\n    }\r\n}"],"sourceRoot":"/source/"}